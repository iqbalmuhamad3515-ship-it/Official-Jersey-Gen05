<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pre-Order Jersey GEN05</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #0a0a0a;
            color: #e5e5e5;
            scroll-behavior: smooth;
        }
        .gold-text {
            color: #d4af37;
        }
        .bg-gold {
            background-color: #d4af37;
        }
        .border-gold {
            border-color: #d4af37;
        }
        .hero-bg {
            /* 1. GAMBAR BACKGROUND */
            background: linear-gradient(rgba(0,0,0,0.75), rgba(0,0,0,0.95)), url('https://github.com/iqbalmuhamad3515-ship-it/Official-Jersey-Gen05/blob/main/Gen05%20Background%20WEB.png?raw=true');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            background-attachment: fixed;
        }
        .glass {
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.08);
        }
        .hover-scale {
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .hover-scale:hover {
            transform: translateY(-8px);
            border-color: rgba(212, 175, 55, 0.5);
            box-shadow: 0 20px 40px rgba(0,0,0,0.4);
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fade-in {
            animation: fadeIn 0.8s ease-out forwards;
        }
        /* Custom Notification */
        #notification {
            display: none;
            position: fixed;
            top: 2rem;
            right: 2rem;
            z-index: 1000;
            animation: slideIn 0.3s ease-out;
        }
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        /* Size Chart Modal */
        #sizeChartModal {
            display: none;
            position: fixed;
            inset: 0;
            z-index: 2000;
            background: rgba(0,0,0,0.9);
            backdrop-filter: blur(10px);
            align-items: center;
            justify-content: center;
            padding: 1rem;
        }
    </style>
</head>
<body class="min-h-screen">

    <!-- Notification Toast -->
    <div id="notification" class="glass p-5 rounded-2xl border-gold/50 border flex items-center gap-4 shadow-2xl max-w-sm">
        <div id="notif-icon" class="w-10 h-10 rounded-full flex items-center justify-center bg-gold text-black">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"></polyline></svg>
        </div>
        <div>
            <h4 id="notif-title" class="font-bold text-white uppercase text-xs tracking-widest">Berhasil</h4>
            <p id="notif-message" class="text-sm text-gray-400">Pesanan telah tercatat di database.</p>
        </div>
    </div>

    <!-- Size Chart Modal -->
    <div id="sizeChartModal" onclick="this.style.display='none'">
        <div class="glass p-8 rounded-[2rem] max-w-2xl w-full border-gold/30 border space-y-6 max-h-[90vh] overflow-y-auto" onclick="event.stopPropagation()">
            <div class="flex justify-between items-center">
                <h3 class="text-2xl font-black uppercase tracking-tighter gold-text">Panduan Ukuran</h3>
                <button onclick="document.getElementById('sizeChartModal').style.display='none'" class="text-gray-400 hover:text-white">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
                </button>
            </div>
            
            <!-- 5. GAMBAR ILUSTRASI PANDUAN UKURAN -->
            <div class="w-full bg-white/5 rounded-2xl overflow-hidden border border-white/10 text-center p-4">
                <!-- GANTI LINK GAMBAR PANDUAN UKURAN DI SINI -->
                <img src="https://github.com/iqbalmuhamad3515-ship-it/Official-Jersey-Gen05/blob/main/Adult%20Size%20Chart.png?raw=true" alt="Ilustrasi Ukuran Jersey" class="mx-auto w-full h-auto object-contain max-h-[400px]" onerror="this.src='https://placehold.co/600x400/000000/d4af37?text=Gambar+Panduan+Ukuran'">
            </div>

            <div class="overflow-x-auto">
                <table class="w-full text-center text-sm">
                    <thead>
                        <tr class="border-b border-white/10 bg-white/5">
                            <th class="p-4 gold-text uppercase">Size</th>
                            <th class="p-4 gold-text uppercase">Lebar (cm)</th>
                            <th class="p-4 gold-text uppercase">Panjang (cm)</th>
                        </tr>
                    </thead>
                    <tbody class="divide-y divide-white/5">
                        <tr><td class="p-3 font-bold">S</td><td class="p-3">48</td><td class="p-3">68</td></tr>
                        <tr><td class="p-3 font-bold">M</td><td class="p-3">50</td><td class="p-3">70</td></tr>
                        <tr><td class="p-3 font-bold">L</td><td class="p-3">52</td><td class="p-3">72</td></tr>
                        <tr><td class="p-3 font-bold">XL</td><td class="p-3">54</td><td class="p-3">74</td></tr>
                        <tr><td class="p-3 font-bold">2XL</td><td class="p-3">56</td><td class="p-3">76</td></tr>
                        <tr><td class="p-3 font-bold">3XL</td><td class="p-3">58</td><td class="p-3">78</td></tr>
                        <tr><td class="p-3 font-bold">4XL</td><td class="p-3">60</td><td class="p-3">80</td></tr>
                        <tr><td class="p-3 font-bold">5XL</td><td class="p-3">62</td><td class="p-3">82</td></tr>
                        <tr><td class="p-3 font-bold text-gold">Custom</td><td class="p-3" colspan="2">Hubungi Admin</td></tr>
                    </tbody>
                </table>
            </div>
            <p class="text-[10px] text-gray-500 italic uppercase text-center">*Toleransi jahitan 1-2 cm</p>
        </div>
    </div>

    <header class="relative min-h-screen flex flex-col items-center justify-center text-center px-4 hero-bg border-b border-gold/10">
        <div class="mb-8 animate-fade-in">
            <!-- 2. LOGO GEN05 -->
            <img src="https://github.com/iqbalmuhamad3515-ship-it/Official-Jersey-Gen05/blob/main/Gen05%20SOLID.png?raw=true" alt="Logo GEN05" class="w-48 h-48 md:w-64 md:h-64 object-contain drop-shadow-[0_0_40px_rgba(212,175,55,0.4)] mx-auto transition-transform duration-700 hover:rotate-3">
        </div>
        <div class="space-y-4 max-w-4xl animate-fade-in" style="animation-delay: 0.2s;">
            <h1 class="text-6xl md:text-9xl font-black uppercase tracking-tighter leading-none">
                Pre-Order <br><span class="gold-text">Jersey GEN05</span>
            </h1>
            <p class="text-xl md:text-3xl text-gray-300 font-light tracking-[0.2em] mt-4 uppercase">"Solid Tanpa Batas"</p>
        </div>
        
        <div class="mt-16 flex flex-wrap justify-center gap-6 animate-fade-in" style="animation-delay: 0.4s;">
            <a href="#view-jersey" class="bg-white/10 backdrop-blur-md border border-white/20 text-white hover:bg-white/20 font-bold py-4 px-12 rounded-full transition duration-300 uppercase tracking-widest text-sm">
                Lihat Jersey
            </a>
            <a href="#order-form" class="bg-gold hover:bg-yellow-500 text-black font-black py-4 px-12 rounded-full transition duration-300 shadow-[0_10px_30px_rgba(212,175,55,0.3)] uppercase tracking-widest text-sm">
                Pesan Sekarang
            </a>
        </div>
    </header>

    <main class="max-w-7xl mx-auto px-6 py-24 space-y-40">
        
        <!-- View Jersey Section -->
        <section id="view-jersey" class="space-y-16">
            <div class="text-center space-y-4">
                <h2 class="text-4xl md:text-6xl font-black uppercase tracking-tighter italic">Edisi <span class="gold-text">Koleksi 2026</span></h2>
                <div class="h-1 w-24 bg-gold mx-auto"></div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-10">
                <div class="jersey-card glass rounded-[2.5rem] overflow-hidden group hover-scale">
                    <div class="relative aspect-square overflow-hidden bg-white/5">
                        <!-- 3. GAMBAR MATCH JERSEY -->
                        <img src="https://github.com/iqbalmuhamad3515-ship-it/Official-Jersey-Gen05/blob/main/Jersey%20Match%20Gen05%202026.png?raw=true" alt="Match Jersey" class="w-full h-full object-cover">
                        <div class="absolute inset-0 bg-gradient-to-t from-black via-transparent to-transparent opacity-60"></div>
                        <div class="absolute bottom-8 left-8">
                            <h3 class="text-3xl font-black uppercase text-white tracking-tighter text-shadow">Match Jersey</h3>
                            <!-- HARGA MATCH JERSEY -->
                            <p class="text-xl font-bold gold-text tracking-widest mt-1">Rp 235.000</p>
                        </div>
                    </div>
                </div>

                <div class="jersey-card glass rounded-[2.5rem] overflow-hidden group hover-scale">
                    <div class="relative aspect-square overflow-hidden bg-white/5 flex items-center justify-center">
                        <!-- 4. GAMBAR CLASS JERSEY -->
                        <img src="https://github.com/iqbalmuhamad3515-ship-it/Official-Jersey-Gen05/blob/main/Jersey%20Class%202%20Gen05%202026.png?raw=true" alt="Class Jersey" class="w-full h-full object-cover">
                        <div class="absolute inset-0 bg-gradient-to-t from-black via-transparent to-transparent opacity-60"></div>
                        <div class="absolute bottom-8 left-8">
                            <h3 class="text-3xl font-black uppercase text-white tracking-tighter text-shadow">Class Jersey</h3>
                            <!-- HARGA CLASS JERSEY -->
                            <p class="text-xl font-bold gold-text tracking-widest mt-1">Rp 210.000</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Order Form -->
        <section id="order-form" class="grid lg:grid-cols-12 gap-16 items-start">
            <div class="lg:col-span-5 space-y-10">
                <h2 class="text-4xl md:text-5xl font-black mb-6 uppercase tracking-tighter">Formulir <span class="gold-text">Pemesanan</span></h2>
                <div class="p-10 bg-gradient-to-br from-yellow-900/40 via-black to-black border border-gold/20 rounded-[2rem]">
                    <h4 class="font-black text-xl gold-text mb-8 uppercase tracking-widest border-b border-gold/10 pb-4">Info Rekening</h4>
                    <p class="text-white text-sm opacity-60 uppercase tracking-widest">Bank BTN</p>
                    <p class="text-3xl font-mono font-black text-white tracking-tighter my-2">3190-1700-0037-21</p>
                    <p class="text-gray-300 font-bold uppercase tracking-widest">Muhamad Iqbal</p>
                </div>
            </div>

            <div class="lg:col-span-7">
                <form id="preOrderForm" class="glass p-10 rounded-[2.5rem] space-y-8 shadow-2xl relative">
                    <div class="space-y-6">
                        <input type="text" id="name" required class="w-full bg-white/5 border border-white/10 rounded-2xl p-5 focus:border-gold outline-none transition-colors" placeholder="Nama Lengkap">
                        
                        <div class="grid md:grid-cols-2 gap-6">
                            <div class="relative">
                                <select id="jerseyOrder" required class="w-full bg-white/5 border border-white/10 rounded-2xl p-5 focus:border-gold outline-none appearance-none cursor-pointer">
                                    <option value="" class="bg-black">Kategori Jersey...</option>
                                    <option value="Match Jersey" class="bg-black text-white">Match Jersey</option>
                                    <option value="Class Jersey" class="bg-black text-white">Class Jersey</option>
                                    <option value="Match and Class Jersey" class="bg-black text-white">Match & Class Jersey</option>
                                </select>
                                <div class="absolute right-5 top-1/2 -translate-y-1/2 pointer-events-none text-gold">▼</div>
                            </div>

                            <div class="relative">
                                <select id="jerseyType" required class="w-full bg-white/5 border border-white/10 rounded-2xl p-5 focus:border-gold outline-none appearance-none cursor-pointer">
                                    <option value="" class="bg-black">Pilih Lengan...</option>
                                    <option value="Short Sleeves" class="bg-black text-white">Short Sleeves (Pendek)</option>
                                    <option value="Long Sleeves" class="bg-black text-white">Long Sleeves (Panjang)</option>
                                </select>
                                <div class="absolute right-5 top-1/2 -translate-y-1/2 pointer-events-none text-gold">▼</div>
                            </div>
                        </div>

                        <!-- SIZE SELECTION SECTION -->
                        <div class="space-y-4">
                            <div class="flex justify-between items-end px-2">
                                <label class="text-xs uppercase font-black gold-text tracking-widest">Pilih Ukuran</label>
                                <button type="button" onclick="document.getElementById('sizeChartModal').style.display='flex'" class="text-[10px] uppercase font-bold text-gray-400 border-b border-gray-600 hover:text-gold hover:border-gold transition-all">
                                    Lihat Size Chart
                                </button>
                            </div>
                            <!-- Container untuk Radio Buttons Ukuran -->
                            <div id="sizeContainer" class="grid grid-cols-4 md:grid-cols-5 gap-3 min-h-[100px]">
                                <!-- Tombol akan di-render di sini oleh JavaScript -->
                            </div>
                        </div>
                    </div>

                    <button type="submit" id="submitBtn" class="w-full bg-gold hover:bg-yellow-500 text-black font-black py-6 rounded-2xl transition-all shadow-xl uppercase tracking-widest disabled:opacity-50 disabled:cursor-not-allowed">
                        Kirim Pesanan
                    </button>
                </form>
            </div>
        </section>

        <!-- Table Recap -->
        <section id="rekap-data" class="space-y-10 pb-20">
            <h2 class="text-4xl font-black uppercase tracking-tighter italic">Live <span class="gold-text">Rekapitulasi</span></h2>
            <div class="overflow-hidden glass rounded-[2.5rem] border border-white/5">
                <div class="overflow-x-auto">
                    <table class="w-full text-left text-sm">
                        <thead class="bg-white/5 border-b border-white/10">
                            <tr>
                                <th class="p-8 gold-text uppercase text-[10px] font-black tracking-widest">Pemesan</th>
                                <th class="p-8 gold-text uppercase text-[10px] font-black tracking-widest">Item</th>
                                <th class="p-8 gold-text uppercase text-[10px] font-black tracking-widest text-center">Tipe</th>
                                <th class="p-8 gold-text uppercase text-[10px] font-black tracking-widest text-center">Size</th>
                                <th class="p-8 gold-text uppercase text-[10px] font-black tracking-widest text-right">Status</th>
                            </tr>
                        </thead>
                        <tbody id="recapTableBody" class="divide-y divide-white/5 font-medium">
                            <!-- JS injects rows here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </section>
    </main>

    <footer class="py-24 text-center border-t border-white/5 bg-black/90 text-gray-400">
        <p class="text-sm uppercase tracking-widest">&copy; 2026 GEN05 Official Jersey. Supported by Bara Tactic Board</p>
    </footer>

    <!-- SDK & Script -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, onAuthStateChanged, signInWithCustomToken } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, collection, addDoc, onSnapshot, query, serverTimestamp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // 1. FUNGSI RENDER UKURAN (Dijalankan Pertama Kali)
        const renderSizes = () => {
            const sizes = ['S', 'M', 'L', 'XL', '2XL', '3XL', '4XL', '5XL', '6XL', '7XL'];
            const sizeContainer = document.getElementById('sizeContainer');
            if (sizeContainer) {
                sizeContainer.innerHTML = '';
                sizes.forEach(size => {
                    const label = document.createElement('label');
                    label.className = "relative group cursor-pointer";
                    label.innerHTML = `
                        <input type="radio" name="size" value="${size}" class="peer absolute opacity-0" required>
                        <div class="text-center py-4 border border-white/10 rounded-2xl peer-checked:bg-gold peer-checked:text-black font-black text-[10px] transition-all hover:bg-white/5 uppercase tracking-tighter">
                            ${size}
                        </div>
                    `;
                    sizeContainer.appendChild(label);
                });
            }
        };

        // Jalankan render ukuran segera setelah DOM siap
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', renderSizes);
        } else {
            renderSizes();
        }

        // Konfigurasi Firebase
        const firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : { apiKey: "", authDomain: "", projectId: "", storageBucket: "", messagingSenderId: "", appId: "" };
        const appId = typeof __app_id !== 'undefined' ? __app_id : "default-gen05-id";
        
        // PASTE URL WEB APP GOOGLE SCRIPT ANDA DI SINI
        const scriptURL = ""; 

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        let userAuthenticated = false;

        // Helper Notifikasi
        function showNotification(title, message, isError = false) {
            const notif = document.getElementById('notification');
            const icon = document.getElementById('notif-icon');
            const nTitle = document.getElementById('notif-title');
            const nMsg = document.getElementById('notif-message');

            if (!notif) return;
            nTitle.innerText = title;
            nMsg.innerText = message;
            
            if (isError) {
                icon.classList.replace('bg-gold', 'bg-red-500');
            } else {
                icon.classList.replace('bg-red-500', 'bg-gold');
            }

            notif.style.display = 'flex';
            setTimeout(() => { notif.style.display = 'none'; }, 5000);
        }

        // Handle Auth
        const initAuth = async () => {
            try {
                if (typeof __initial_auth_token !== 'undefined' && __initial_auth_token) {
                    await signInWithCustomToken(auth, __initial_auth_token);
                } else {
                    await signInAnonymously(auth);
                }
            } catch (error) {
                console.error("Auth error:", error);
            }
        };

        onAuthStateChanged(auth, (user) => {
            if (user) {
                userAuthenticated = true;
                startListeningToData();
            }
        });

        initAuth();

        // Real-time Data dari Firestore
        function startListeningToData() {
            if (!userAuthenticated) return;
            const q = query(collection(db, 'artifacts', appId, 'public', 'data', 'orders'));
            onSnapshot(q, (snapshot) => {
                const table = document.getElementById('recapTableBody');
                if (!table) return;
                table.innerHTML = '';
                const orders = [];
                snapshot.forEach(doc => orders.push({ id: doc.id, ...doc.data() }));
                orders.sort((a, b) => (b.createdAt?.seconds || 0) - (a.createdAt?.seconds || 0));

                orders.forEach((data) => {
                    table.innerHTML += `
                        <tr class="hover:bg-white/[0.02] border-b border-white/5 transition-colors">
                            <td class="p-8 font-black text-white uppercase tracking-tight">${data.name || '-'}</td>
                            <td class="p-8 text-gray-400 text-xs">${data.jersey || '-'}</td>
                            <td class="p-8 text-center text-gray-400 text-xs">${data.type || '-'}</td>
                            <td class="p-8 text-center"><span class="bg-gold text-black px-3 py-1 rounded font-black text-[10px]">${data.size || '-'}</span></td>
                            <td class="p-8 text-right"><span class="text-[10px] gold-text font-black uppercase tracking-widest">Pending TF</span></td>
                        </tr>`;
                });
            });
        }

        // Form Submission
        const form = document.getElementById('preOrderForm');
        if (form) {
            form.addEventListener('submit', async (e) => {
                e.preventDefault();
                if (!userAuthenticated) {
                    showNotification("Error", "Koneksi sistem belum siap.", true);
                    return;
                }

                const submitBtn = document.getElementById('submitBtn');
                const selectedSize = document.querySelector('input[name="size"]:checked');
                
                if (!selectedSize) {
                    showNotification("Error", "Harap pilih ukuran (Size) terlebih dahulu.", true);
                    return;
                }

                submitBtn.disabled = true;
                submitBtn.textContent = "MENGIRIM...";

                const payload = {
                    name: document.getElementById('name').value,
                    jersey: document.getElementById('jerseyOrder').value,
                    type: document.getElementById('jerseyType').value,
                    size: selectedSize.value
                };

                try {
                    await addDoc(collection(db, 'artifacts', appId, 'public', 'data', 'orders'), {
                        ...payload,
                        userId: auth.currentUser?.uid,
                        createdAt: serverTimestamp()
                    });

                    if (scriptURL) {
                        await fetch(scriptURL, {
                            method: 'POST',
                            mode: 'no-cors',
                            cache: 'no-cache',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(payload)
                        });
                    }
                    
                    showNotification("Berhasil", "Pesanan Anda telah tercatat!");
                    form.reset();
                    renderSizes(); // Reset pilihan ukuran secara visual
                } catch (error) {
                    console.error(error);
                    showNotification("Error", "Gagal mengirim data. Coba lagi.", true);
                } finally {
                    submitBtn.disabled = false;
                    submitBtn.textContent = "KIRIM PESANAN";
                }
            });
        }
    </script>
</body>
</html>
